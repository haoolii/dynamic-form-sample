<div class="container">
  <h1>Section & Case Type Selector</h1>

  <div class="selectors">
    <div class="form-group">
      <label for="section">Section:</label>
      <select
        id="section"
        [value]="section() || ''"
        (change)="onSectionChange($event)"
        class="form-control">
        <option value="">-- Select Section --</option>
        @for (sec of sections; track sec) {
          <option [value]="sec">{{ sec }}</option>
        }
      </select>
    </div>

    @if (section()) {
      <div class="form-group">
        <label for="caseType">Case Type:</label>
        <select
          id="caseType"
          [value]="caseType() || ''"
          (change)="onCaseTypeChange($event)"
          class="form-control">
          <option value="">-- Select Case Type --</option>
          @for (type of caseTypes; track type) {
            <option [value]="type">{{ type }}</option>
          }
        </select>
      </div>
    }
  </div>

  <div class="status">
    @if (loading()) {
      <p class="loading">Loading...</p>
    }
    @if (!loading() && section() && caseType() && fields().length > 0) {
      <p class="info">
        âœ“ Loaded from {{ cache()[section()! + '_' + caseType()!] ? 'cache' : 'API' }}
      </p>
    }
  </div>

  @if (fields().length > 0) {
    <div class="results">
      <h2>Fields:</h2>
      <ul>
        @for (field of fields(); track field) {
          <li>{{ field }}</li>
        }
      </ul>
    </div>
  }

  <div class="cache-info">
    <h3>Cache Status:</h3>
    <p>Cached items: {{ Object.keys(cache()).length }}</p>
    @if (Object.keys(cache()).length > 0) {
      <button (click)="clearCache()" class="btn-clear">
        Clear Cache
      </button>
      <div class="cached-keys">
        <strong>Cached keys:</strong>
        @for (key of Object.keys(cache()); track key) {
          <span class="cache-key">{{ key }}</span>
        }
      </div>
    }
  </div>
</div>
